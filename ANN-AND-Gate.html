<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AND Gate Neural Network</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
</head>
<body>

<h2>AND Gate Neural Network</h2>

<!-- ‡∏õ‡∏∏‡πà‡∏° Train & Continue Training -->
<button onclick="trainModel()">Train New Model</button>
<button onclick="continueTraining()">Continue Training</button>
<button onclick="saveModel()">Save Model</button>
<br><br>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå -->
<input type="file" id="modelUpload" multiple>
<button onclick="loadModelFromFile()">Load Model</button>
<br><br>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• -->
<button onclick="testModel(1,1)">Test [1,1]</button>
<button onclick="testModel(0,1)">Test [0,1]</button>
<button onclick="testModel(1,0)">Test [1,0]</button>
<button onclick="testModel(0,0)">Test [0,0]</button>
<p id="result">Result: </p>

<script>
let model; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
const EPOCHS = 1000; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏ô

// üìå 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÉ‡∏´‡∏°‡πà (Train New Model)
async function trainModel() {
    console.log("üöÄ Training New Model...");
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• ANN ‡πÉ‡∏´‡∏°‡πà
    model = tf.sequential();
    model.add(tf.layers.dense({ units: 4, activation: 'relu', inputShape: [2] }));
    model.add(tf.layers.dense({ units: 1, activation: 'sigmoid' })); 

    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
    model.compile({ optimizer: 'adam', loss: 'binaryCrossentropy', metrics: ['accuracy'] });

    await trainAndLog();
}

// üìå 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ï‡πà‡∏≠ (Continue Training)
async function continueTraining() {
    if (!model) {
        document.getElementById("result").innerText = "Load Model First!";
        return;
    }

    console.log("üöÄ Continuing Training...");
    
    // ‚úÖ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! ‡∏ï‡πâ‡∏≠‡∏á `compile()` ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡∏£‡∏ô‡∏ï‡πà‡∏≠
    model.compile({ optimizer: 'adam', loss: 'binaryCrossentropy', metrics: ['accuracy'] });

    await trainAndLog();
}

// üìå 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô)
async function trainAndLog() {
    const xs = tf.tensor2d([[0,0], [0,1], [1,0], [1,1]]);
    const ys = tf.tensor2d([[0], [0], [0], [1]]);

    await model.fit(xs, ys, { epochs: EPOCHS });
    
    console.log("‚úÖ Training Completed!");
    document.getElementById("result").innerText = "Training Completed!";
}

// üìå 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• (Save Model)
async function saveModel() {
    if (!model) {
        alert("Train the model first!");
        return;
    }
    
    await model.save('downloads://my_and_gate_model');
    console.log("‚úÖ Model Saved!");
    document.getElementById("result").innerText = "Model Saved!";
}

// üìå 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå (Load Model)
async function loadModelFromFile() {
    const inputElement = document.getElementById('modelUpload');

    if (inputElement.files.length < 2) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á .json ‡πÅ‡∏•‡∏∞ .bin");
        return;
    }

    const jsonFile = Array.from(inputElement.files).find(file => file.name.endsWith('.json'));
    const weightsFile = Array.from(inputElement.files).find(file => file.name.endsWith('.bin'));

    if (!jsonFile || !weightsFile) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
    }

    try {
        model = await tf.loadLayersModel(tf.io.browserFiles([jsonFile, weightsFile]));
        console.log("‚úÖ Model Loaded Successfully!");
        document.getElementById("result").innerText = "Model Loaded!";
    } catch (error) {
        console.error("‚ùå Error loading model:", error);
        document.getElementById("result").innerText = "Error loading model!";
    }
}

// üìå 6. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• (Test Model)
async function testModel(x1, x2) {
    if (!model) {
        document.getElementById("result").innerText = "Load or Train Model First!";
        return;
    }
    
    let input = tf.tensor2d([[x1, x2]]);
    let prediction = model.predict(input);
    let result = await prediction.data();
    
    document.getElementById("result").innerText = `AND(${x1},${x2}) = ${result[0].toFixed(4)}`;
    console.log(`AND(${x1},${x2}) = ${result[0].toFixed(4)}`);
}
</script>

</body>
</html>

